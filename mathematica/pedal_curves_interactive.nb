(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     12120,        334]
NotebookOptionsPosition[     11692,        318]
NotebookOutlinePosition[     12036,        333]
CellTagsIndexPosition[     11993,        330]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"angle", "[", 
     RowBox[{"n_", ",", " ", "fnfact_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{"2", "*", "Pi", "*", 
      RowBox[{"fnfact", "[", "n", "]"}]}], ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rotate", "[", "alpha_", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"x", "=", 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "alpha", "]"}]}]}], ";", 
      RowBox[{"y", "=", 
       RowBox[{"Cos", "[", "alpha", "]"}]}], ";", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}]}], ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"intersectLines", "[", 
     RowBox[{"line1_", ",", "line2_"}], "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a11", "=", 
       RowBox[{
        RowBox[{"line1", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}], "-", 
        RowBox[{"line1", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ";", 
      RowBox[{"a12", "=", 
       RowBox[{
        RowBox[{"line1", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}], "-", 
        RowBox[{"line1", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], ";", 
      RowBox[{"det1", "=", 
       RowBox[{"Det", "[", "line1", "]"}]}], ";", 
      RowBox[{"a21", "=", 
       RowBox[{
        RowBox[{"line2", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}], "-", 
        RowBox[{"line2", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ";", 
      RowBox[{"a22", "=", 
       RowBox[{
        RowBox[{"line2", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}], "-", 
        RowBox[{"line2", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], ";", 
      RowBox[{"det2", "=", 
       RowBox[{"Det", "[", "line2", "]"}]}], ";", 
      RowBox[{"detx", "=", 
       RowBox[{"Det", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a12", ",", "det1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"a22", ",", "det2"}], "}"}]}], "}"}], "]"}]}], ";", 
      RowBox[{"dety", "=", 
       RowBox[{"Det", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"det1", ",", "a11"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"det2", ",", "a21"}], "}"}]}], "}"}], "]"}]}], ";", 
      RowBox[{"det", "=", 
       RowBox[{"Det", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a11", ",", "a12"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"a21", ",", "a22"}], "}"}]}], "}"}], "]"}]}], ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"det", ">", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"detx", "/", "det"}], ",", 
          RowBox[{"dety", "/", "det"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"generatePlot", "[", 
     RowBox[{
     "fnline_", ",", "fnfact_", ",", " ", "step_", ",", " ", "amount_"}], 
     "]"}], ":=", " ", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"start", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"e", "=", "0.001"}], ";", "\[IndentingNewLine]", 
      RowBox[{"lines1", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"rotate", "[", 
            RowBox[{"angle", "[", 
             RowBox[{"n", ",", " ", "fnfact"}], "]"}], "]"}], ",", 
           RowBox[{"rotate", "[", 
            RowBox[{"angle", "[", 
             RowBox[{
              RowBox[{"fnline", "[", "n", "]"}], ",", " ", "fnfact"}], "]"}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "start", ",", "amount", ",", "step"}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"lines2", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"rotate", "[", 
            RowBox[{"angle", "[", 
             RowBox[{
              RowBox[{"n", "+", "e"}], ",", " ", "fnfact"}], "]"}], "]"}], 
           ",", 
           RowBox[{"rotate", "[", 
            RowBox[{"angle", "[", 
             RowBox[{
              RowBox[{"fnline", "[", 
               RowBox[{"n", "+", "e"}], "]"}], ",", " ", "fnfact"}], "]"}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "start", ",", "amount", ",", "step"}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plot1", "=", 
       RowBox[{"Graphics", "[", 
        RowBox[{"{", 
         RowBox[{"Blue", ",", " ", 
          RowBox[{"Thickness", "[", "0.0001", "]"}], ",", 
          RowBox[{"Map", "[", 
           RowBox[{"Arrow", ",", "lines1"}], "]"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"plot2", "=", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{"MapThread", "[", 
          RowBox[{"intersectLines", ",", 
           RowBox[{"{", 
            RowBox[{"lines1", ",", "lines2"}], "}"}]}], "]"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", " ", 
         RowBox[{"PlotStyle", "\[Rule]", "Blue"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"GraphicsGrid", "[", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"plot1", ",", "plot2"}], "}"}], "}"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"dynamicPlot", "[", 
     RowBox[{"factor_", ",", "base_", ",", "amount_"}], "]"}], ":=", " ", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"fnline", "[", "n_", "]"}], ":=", 
       RowBox[{"n", "*", "factor"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fnfact", "[", "n_", "]"}], ":=", 
       RowBox[{"n", "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"base", "^", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Floor", "[", 
              RowBox[{"Log", "[", 
               RowBox[{"base", ",", "n"}], "]"}], "]"}], "+", "1"}], ")"}]}], 
          "-", 
          RowBox[{"base", "^", 
           RowBox[{"Floor", "[", 
            RowBox[{"Log", "[", 
             RowBox[{"base", ",", "n"}], "]"}], "]"}]}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"generatePlot", "[", 
       RowBox[{"fnline", ",", " ", "fnfact", ",", "1", ",", " ", "amount"}], 
       "]"}]}], "\[IndentingNewLine]", ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"dynamicPlot", "[", 
    RowBox[{"factor", ",", "base", ",", "amount"}], "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"factor", ",", "3", ",", " ", "\"\<Factor\>\""}], "}"}], ",", 
     "1", ",", "100", ",", "1"}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"base", ",", "2", ",", " ", "\"\<Base\>\""}], "}"}], ",", "1", 
     ",", "100", ",", "1"}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"amount", ",", "100", ",", " ", "\"\<Amount\>\""}], "}"}], ",", 
     "50", ",", "500", ",", "1"}], "}"}]}], "]"}]}], "Input",
 CellLabel->"In[8]:=",ExpressionUUID->"3ee36a86-bc21-42ec-a9d0-8b02fd44f6aa"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`amount$$ = 100, $CellContext`base$$ = 
    2, $CellContext`factor$$ = 3, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`factor$$], 3, "Factor"}, 1, 100, 1}, {{
       Hold[$CellContext`base$$], 2, "Base"}, 1, 100, 1}, {{
       Hold[$CellContext`amount$$], 100, "Amount"}, 50, 500, 1}}, 
    Typeset`size$$ = {600., {154., 159.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`factor$11079$$ = 0, $CellContext`base$11080$$ = 
    0, $CellContext`amount$11081$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`amount$$ = 100, $CellContext`base$$ = 
        2, $CellContext`factor$$ = 3}, "ControllerVariables" :> {
        Hold[$CellContext`factor$$, $CellContext`factor$11079$$, 0], 
        Hold[$CellContext`base$$, $CellContext`base$11080$$, 0], 
        Hold[$CellContext`amount$$, $CellContext`amount$11081$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> $CellContext`dynamicPlot[$CellContext`factor$$, \
$CellContext`base$$, $CellContext`amount$$], 
      "Specifications" :> {{{$CellContext`factor$$, 3, "Factor"}, 1, 100, 
         1}, {{$CellContext`base$$, 2, "Base"}, 1, 100, 
         1}, {{$CellContext`amount$$, 100, "Amount"}, 50, 500, 1}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{651., {229., 235.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.831089537088113*^9, {3.8310896053028965`*^9, 3.831089608469298*^9}, 
   3.831089655716856*^9, 3.8310897212642317`*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"f355b33e-944c-4570-84d5-6977712de0a9"]
}, Open  ]]
},
WindowSize->{2560, 1357},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 8628, 244, 675, "Input",ExpressionUUID->"3ee36a86-bc21-42ec-a9d0-8b02fd44f6aa"],
Cell[9211, 268, 2465, 47, 483, "Output",ExpressionUUID->"f355b33e-944c-4570-84d5-6977712de0a9"]
}, Open  ]]
}
]
*)

